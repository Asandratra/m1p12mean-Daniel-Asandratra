"use strict";(self.webpackChunkmantis_free_version=self.webpackChunkmantis_free_version||[]).push([[568],{568:(_,l,s)=>{s.r(l),s.d(l,{FormValiderDemandeComponent:()=>v});var e=s(4438),d=s(5447),m=s(177),i=s(4341),h=s(6961),D=s(2910);function g(r,u){if(1&r&&(e.j41(0,"p",11),e.EFF(1),e.k0s()),2&r){const t=e.XpG();e.R7$(),e.JRh(t.errorMessage)}}function p(r,u){if(1&r&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.nI1(3,"date"),e.k0s(),e.j41(4,"td",22),e.EFF(5),e.k0s(),e.j41(6,"td",22),e.EFF(7),e.k0s()()),2&r){const t=u.$implicit;e.R7$(2),e.JRh(e.i5U(3,4,t.dateHeure,"dd/MM/yyyy \xe0 HH:mm")),e.R7$(3),e.Lme("",t.idClient.nom," ",t.idClient.prenom,""),e.R7$(2),e.JRh(t.idClient.tel)}}let v=(()=>{class r{constructor(t,a,n){this.demandeRDVService=t,this.rendezVousService=a,this.activatedRoute=n,this.errorMessage="",this.changerDate=!1,this.dateHeure="",this.status=0,this.router=(0,e.WQX)(d.Ix)}ngOnInit(){const t=sessionStorage.getItem("currentUser");t?this.currentUser=t:this.router.navigateByUrl("manager"),this.activatedRoute.params.subscribe(a=>{this.loadDemandeRDVById(a.id)})}switchChangeDate(){this.changerDate=!this.changerDate}loadDemandeRDVById(t){this.demandeRDVService.getDemandesRDVByid(t).subscribe(a=>{this.demandeRDV=a,this.garage=a.idGarage,this.client=a.idClient,this.loadNextRendezVous(a.idGarage._id)})}loadNextRendezVous(t){this.rendezVousService.get10NextOfAGarage(t).subscribe(a=>{this.nextRendezVous=a})}updateDemandeRDV(){this.errorMessage="",this.changerDate?this.dateHeure?this.demandeRDVService.updateDemandeRDV(this.demandeRDV._id,{dateHeure:this.dateHeure,status:1}).subscribe(a=>{alert("Demande de confirmation de rendez-vous envoy\xe9e."),this.dateHeure=""},a=>{this.errorMessage=a.message}):this.errorMessage="Veuillez bien sp\xe9cifier la date \xe0 laquelle vous souhaitez proposer le rendez-vous.":this.demandeRDVService.updateDemandeRDV(this.demandeRDV._id,{status:1}).subscribe(a=>{this.router.navigateByUrl("manager/demandes-rendez-vous/1")},a=>{this.errorMessage=a.message})}static{this.\u0275fac=function(a){return new(a||r)(e.rXU(h.y),e.rXU(D.N),e.rXU(d.nX))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-form-valider-demande"]],decls:52,vars:11,consts:[[1,"card","d-flex","justify-content-center"],[1,"card-body","col-x1-12"],[1,"mb-4"],[1,"row"],[1,"col-sm-7"],[1,"card"],[1,"list-group","list-group-flush",2,"font-size","larger"],[1,"list-group-item"],[1,"col-sm-5"],[1,"card-body"],[1,"card-title"],[1,"text","text-danger"],[3,"ngSubmit"],[1,"form-group"],["type","checkbox",3,"change"],["type","datetime-local","id","date-heure","name","date-heure",1,"form-control",3,"ngModelChange","ngModel","disabled"],[1,"row","text-end"],[1,"col"],["type","submit",1,"btn","btn-primary"],[1,"card","tbl-card"],[1,"table-responsive"],[1,"table","table-hover","mb-0"],[1,"text-center"]],template:function(a,n){1&a&&(e.j41(0,"div",0)(1,"div",1)(2,"h4",2),e.EFF(3),e.k0s(),e.j41(4,"div",3)(5,"div",4)(6,"h5",2),e.EFF(7,"Demande de rendez-vous"),e.k0s(),e.j41(8,"div",5)(9,"ul",6)(10,"li",7),e.EFF(11),e.nI1(12,"date"),e.k0s(),e.j41(13,"li",7),e.EFF(14),e.k0s(),e.j41(15,"li",7),e.EFF(16),e.k0s()()()(),e.j41(17,"div",8)(18,"div",5)(19,"div",9)(20,"h5",10),e.EFF(21,"Valider demande"),e.k0s(),e.DNE(22,g,2,1,"p",11),e.j41(23,"form",12),e.bIt("ngSubmit",function(){return n.updateDemandeRDV()}),e.j41(24,"div",13)(25,"input",14),e.bIt("change",function(){return n.switchChangeDate()}),e.k0s(),e.j41(26,"label"),e.EFF(27," Proposer une autre date"),e.k0s(),e.j41(28,"input",15),e.mxI("ngModelChange",function(o){return e.DH7(n.dateHeure,o)||(n.dateHeure=o),o}),e.k0s()(),e.j41(29,"div",16)(30,"div",17)(31,"button",18),e.EFF(32,"Valider"),e.k0s()()()()()()()()()(),e.j41(33,"div",0)(34,"div",1)(35,"h5",2),e.EFF(36,"Les prochains rendez-vous"),e.j41(37,"h5")(38,"div",19)(39,"div",20)(40,"table",21)(41,"thead")(42,"tr")(43,"th"),e.EFF(44,"DATE DE RENDEZ-VOUS"),e.k0s(),e.j41(45,"th",22),e.EFF(46,"CLIENT"),e.k0s(),e.j41(47,"th",22),e.EFF(48,"TEL. CLIENT"),e.k0s()()(),e.j41(49,"tbody"),e.Z7z(50,p,8,7,"tr",null,e.fX1),e.k0s()()()()()()()()),2&a&&(e.R7$(3),e.SpI("Le garage peut acceuillir ",n.demandeRDV.idGarage.place," v\xe9hicule(s) en m\xeame temps"),e.R7$(8),e.SpI("Date demand\xe9e : ",e.i5U(12,8,n.demandeRDV.dateHeure,"dd/MM/yyyy \xe0 HH:mm"),""),e.R7$(3),e.Lme("Client : ",n.client.nom," ",n.client.prenom,""),e.R7$(2),e.SpI("Tel. Client : ",n.client.tel,""),e.R7$(6),e.vxM(n.errorMessage?22:-1),e.R7$(6),e.R50("ngModel",n.dateHeure),e.Y8G("disabled",!n.changerDate),e.R7$(22),e.Dyx(n.nextRendezVous))},dependencies:[d.iI,m.MD,m.vh,i.YN,i.qT,i.me,i.BC,i.cb,i.vS,i.cV],encapsulation:2})}}return r})()}}]);